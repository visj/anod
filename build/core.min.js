var anod=(function(){var f;function h(){this.S=[];this.i=0}function l(a,b){a.S[a.i++]=b}function aa(a,b){for(var c=a.S,d=0;d<a.i;d++)c[d].N(b),c[d]=null;a.i=0}function ba(a){for(var b=n,c=b.S,d=0;d<b.i;d++){var e=c[d],g=a,k=e.g;if(k&64){var r=e.G;r.s<g&&r.C<g&&r.U(g)}if(k&128){e=e.v;k=e.length;for(var m=0;m<k;m++)r=e[m],r.s<g&&r.C<g&&r.U(g)}c[d]=null}b.i=0}function ca(a,b){for(var c=a.S,d=0;d<a.i;d++){var e=c[d];e.g&32&&e.N(b);c[d]=null}a.i=0}var da={},p=1,t=new h,u=new h,n=new h,w=new h,x=new h,y=new h,z={u:!0,l:null, m:null};function A(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a}function B(){t.i=u.i=w.i=x.i=y.i=0}function C(a,b){var c=b.B,d=-1,e=null===b.A?-1:null===c?0:c.length;0<=e&&(b.A===a||0<e&&(1===e?c[0]===a:c[e-1]===a||c[e-2]===a))||(null===a.G?(a.G=b,a.M=e,a.g|=64):(null===a.v?(d=0,a.v=[b],a.J=[e]):(d=a.v.length,a.v[d]=b,a.J[d]=e),a.g|=128),null===b.A?(b.A=a,b.T=d,b.g|=256):(null===b.B?(b.B=[a],b.K=[d]):(b.B[e]=a,b.K[e]=d),b.g|=512))}function ea(){var a=z.l,b=z.m;z.u=!1;try{fa()}finally{z.u= !0,z.l=a,z.m=b}}function fa(){for(var a,b=0;0!==u.i||0!==n.i||0!==w.i||0!==y.i||0!==x.i||0!==t.i;){a=++p;if(0!==t.i){for(var c=t,d=c.S,e=0;e<c.i;e++)d[e].F(),d[e]=null;c.i=0}0!==u.i&&aa(u,a);0!==n.i&&ba(a);0!==w.i&&ca(w,a);0!==x.i&&ca(x,a);0!==y.i&&aa(y,a);if(1E5<b++)throw Error("Runaway clock detected");}}function D(a,b){var c,d=a.g;if(d&16384){var e=a.h;for(c=e.length-1;0<=c;c--)e[c].F();a.g&=-16385;b?a.h=null:e.length=0}if(d&32768){d=a.o;for(c=d.length-1;0<=c;c--)d[c](!0);a.g&=-32769;b?a.o=null: d.length=0}}function E(){}E.prototype.dispose=function(){this.g&13||(z.u?this.F():(this.g|=8,l(t,this)))};function F(){}A(F,E);F.prototype.peek=function(){return this.h};function G(a){this.g=0;this.h=[];this.o=null;var b=z.l,c=z.m;z.l=this;z.m=null;try{a()}finally{z.l=b,z.m=c}}A(G,E);G.prototype.F=function(){1!==this.g&&(D(this,!0),this.g=1)};function H(a){var b=a.g;b&64&&(ha(a.G,a.M),a.G=null);if(b&128)for(b=a.v.length;b--;)ha(a.v[b],a.J[b]);a.P=a.v=a.J=null}function ia(a,b){if(1!==a.g)if(-1===b)a.G= null,a.g&=-65;else{var c=a.v,d=a.J,e=c.pop(),g=d.pop(),k=c.length;b!==k&&(c[b]=e,d[b]=g,-1===g?e.T=b:e.K[g]=b);0===k&&(a.g&=-129)}}function ha(a,b){if(1!==a.g){if(-1===b)a.A=null,a.g&=-257;else{var c=a.B,d=a.K,e=c.pop(),g=d.pop(),k=c.length;b!==k&&(c[b]=e,d[b]=g,-1===g?e.M=b:e.J[g]=b);0===k&&(a.g&=-513)}a.g&768||a.R()}}function ja(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d];e.s<b&&e.I<b&&e.W(b)}}function ka(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d];e.g&5||e.X(b)}}function I(a,b){var c=a.g; c&64&&a.G.s<b&&a.G.V(b);if(c&128){c=a.v;for(var d=c.length,e=0;e<d;e++)a=c[e],a.s<b&&a.V(b)}}function J(a,b){var c=a.g;c&256&&(ia(a.A,a.T),a.A=null);if(c&512){c=a.B.length;for(var d=0;d<c;d++)ia(a.B[d],a.K[d]);b?(a.B=null,a.K=null):(a.B.length=0,a.K.length=0)}a.g&=-769}function K(a,b){var c=a.g;if(c&1024)throw Error("Circular dependency");if(c&32&&a.I<b)a.N(b);else if(c&50&&(a.C===b||a.I===b)){if(c&2048)throw Error("Circular clearing dependency");a.g|=2048;a.g&2&&a.I===b&&(a.g&=-3,c=a.l,c.g&50&&K(c, b));a:if(16===(a.g&53)&&a.C===b){if(a.g&256){var d=a.A;c=d.g;if(c&32||c&16&&d.C===b)if(K(d,b),a.g&36)break a}if(a.g&512)for(var e=a.B,g=e.length,k=0;k<g;k++)if(d=e[k],c=d.g,c&32||c&16&&d.C===b)if(K(d,b),a.g&36)break a}a.g&=-2067;a.g&32&&a.N(b)}}function L(a,b,c){c=32|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.l=this.o=this.h=null;this.j=a;this.A=null;this.T=0;this.K=this.B=null;this.I=this.C=this.s=0;a=z.u;b=z.l;c=z.m;if(null!==b){b.g|=16384;var d=b.h;null===d?b.h=[this]:d[d.length]=this}z.l= z.m=this;a&&(B(),z.u=!1);try{this.D(),!a||0===u.i&&0===t.i||fa()}finally{z.u=a,z.l=b,z.m=c,this.g&768||this.R()}}A(L,E);f=L.prototype;f.F=function(){var a=this.g;1!==a&&(a&49152&&D(this,!0),a&768&&J(this,!0),this.j=null,this.g=1)};f.R=function(){this.j=this.l=this.B=this.K=null};f.W=function(a){this.I=a;this.g=(this.g|2)&-2049;this.C<a&&this.g&16384&&ja(this.h,a)};f.X=function(a){var b=this.s;this.s=a;this.g=(this.g|4)&-51;b<a&&this.g&16384&&ka(this.h,a)};f.U=function(a){this.C=a;this.g=(this.g|16)& -2049;this.I<a&&this.g&16384&&ja(this.h,a)};f.V=function(a){this.s=a;this.g=(this.g|32)&-17;l(y,this);this.g&16384&&ka(this.h,a)};f.D=function(){this.j()};f.N=function(){var a=this.g,b=z.l,c=z.m;z.l=z.m=null;a&49152&&D(this,!1);a&131072&&(J(this,!1),z.m=this);this.g=(a|1024)&-2099;z.l=this;try{this.D()}finally{this.g&=-1025,z.l=b,z.m=c,this.g&768||this.R()}};function M(a,b,c){c=65568|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.h=void 0;this.G=null;this.M=-1;this.A=this.l=this.J=this.v=null;this.T= 0;this.K=this.B=null;this.I=this.C=this.s=0;this.P=void 0;this.j=a;a=z.l;null!==a&&(a.g|=16384,b=a.h,null===b?a.h=[this]:b[b.length]=this)}A(M,F);f=M.prototype;f.peek=function(){var a=this.g;!(a&5)&&a&1074&&K(this,p);return this.h};f.val=function(){var a=this.g;if(!(a&5)){a&1074&&K(this,p);var b;this.g&13||null===(b=z.m)||C(this,b)}return this.h};f.F=function(){var a=this.g;1!==a&&(this.h=this.j=this.P=null,a&192&&H(this),a&768&&J(this,!0),this.g=1)};f.R=function(){this.g&192&&H(this);this.j=this.P= null};f.D=function(){this.h=this.j()};f.N=function(a){this.s=a;var b=this.g,c=z.u,d=z.l,e=z.m;z.l=z.m=null;this.g=(this.g|1024)&-2099;b&196608&&(b&65536?this.g&=-65537:J(this,!1),b&262144||(z.m=this));var g=this.h;c&&(B(),z.u=!1);try{this.D(),b&192&&g!==this.h&&(I(this,a),0!==n.i&&ba(a)),!c||0===u.i&&0===t.i||fa()}finally{this.g&=-1025,z.u=c,z.l=d,z.m=e,this.g&768||this.R()}};f.X=function(a){this.s=a;this.g=(this.g|4)&-51};f.W=function(a){this.I=a;this.g=(this.g|2)&-2049};f.U=function(a){this.C=a; this.g=(this.g|16)&-2049;this.g&192&&l(n,this)};f.V=function(a){this.s=a;this.g=(this.g|32)&-2065;this.g&192&&(l(w,this),this.C<a&&l(n,this))};function N(a,b){var c=0;void 0!==b&&(c=null===b?c|4096:c|8192);this.g=c;this.h=a;this.j=da;this.P=b;this.G=null;this.M=-1;this.J=this.v=null}A(N,F);f=N.prototype;f.val=function(){var a;this.g&13||null===(a=z.m)||C(this,a);return this.h};f.set=function(a){var b=this.g;if(!(b&9)&&(b&4096||(b&8192?!this.P(a,this.h):a!==this.h)))if(z.u)this.h=a,b&192&&(B(),I(this, p+1),ea());else if(this.j===da)this.j=a,this.g|=32,l(u,this);else if(a!==this.j)throw Error("Conflicting values");};f.F=function(){1!==this.g&&(H(this),this.h=this.j=null,this.g=1)};f.D=function(){this.h=this.j;this.j=da;this.g&=-33};f.N=function(a){this.D();I(this,a)};return{root:function(a){return new G(a)},data:function(a){return new N(a,null)},value:function(a,b){return new N(a,b)},compute:function(a,b){return new M(a,b)},$compute:function(a, b){return new M(a,b,131072)},effect:function(a,b){return new L(a,b)},$effect:function(a,b){return new L(a,b,131072)},batch:function(a){z.u?(z.u=!1,B(),a(),ea()):a()},sample:function(a){var b=z.m;z.m=null;a=a();z.m=b;return a},cleanup:function(a){var b=z.l;if(null!==b){b.g|=32768;var c=b.o;null===c?b.o=[a]:c[c.length]=a}},stable:function(){var a=z.l;null!==a&&(a.g&=-131073)},Root:G,Data:N,Effect: L,Compute:M,F:F,A:A,M:M,C:C,z:z,H:H,G:G,D:D,N:N,B:B,I:I,p:p,ea:ea,l:l,u:u}})();