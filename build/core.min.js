var anod=(function(){var f;function h(){this.R=[];this.i=0}function k(a,b){a.R[a.i++]=b}function aa(a,b){for(var c=a.R,d=0;d<a.i;d++)c[d].L(b),c[d]=null;a.i=0}function ba(a){for(var b=m,c=b.R,d=0;d<b.i;d++){var e=c[d],g=a,l=e.g;if(l&64){var n=e.A;n.u<g&&n.C<g&&n.T(g)}if(l&128){e=e.s;l=e.length;for(var D=0;D<l;D++)n=e[D],n.u<g&&n.C<g&&n.T(g)}c[d]=null}b.i=0}function ca(a,b){for(var c=a.R,d=0;d<a.i;d++){var e=c[d];e.g&32&&e.L(b);c[d]=null}a.i=0}var p={},q=1,r=new h,t=new h,m=new h,u=new h,v=new h,w=new h,x={v:!0,j:null, m:null};function y(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a}function z(){r.i=t.i=u.i=v.i=w.i=0}function A(a,b){var c=b.D,d=b.B,e=-1,g=null===c?-1:null===d?0:d.length;!(b.g&65536)&&0<=g&&(c===a||0<g&&(1===g?d[0]===a:d[g-1]===a||d[g-2]===a))||(null===a.A?(a.A=b,a.K=g,a.g|=64):(null===a.s?(e=0,a.s=[b],a.G=[g]):(e=a.s.length,a.s[e]=b,a.G[e]=g),a.g|=128),null===b.D?(b.D=a,b.S=e,b.g|=256):(null===b.B?(b.B=[a],b.I=[e]):(b.B[g]=a,b.I[g]=e),b.g|=512))}function B(){var a=x.j,b= x.m;x.v=!1;try{C()}finally{x.v=!0,x.j=a,x.m=b}}function C(){for(var a,b=0;0!==t.i||0!==m.i||0!==u.i||0!==w.i||0!==v.i||0!==r.i;){a=++q;if(0!==r.i){for(var c=r,d=c.R,e=0;e<c.i;e++)d[e].J(),d[e]=null;c.i=0}0!==t.i&&aa(t,a);0!==m.i&&ba(a);0!==u.i&&ca(u,a);0!==v.i&&ca(v,a);0!==w.i&&aa(w,a);if(1E5<b++)throw Error("Runaway clock detected");}}function E(a,b){var c,d=a.g;if(d&16384){var e=a.h;for(c=e.length-1;0<=c;c--)e[c].J();a.g&=-16385;b?a.h=null:e.length=0}if(d&32768){d=a.o;for(c=d.length-1;0<=c;c--)d[c](!0); a.g&=-32769;b?a.o=null:d.length=0}}function F(){}F.prototype.dispose=function(){this.g&13||(x.v?this.J():(this.g|=8,k(r,this)))};function G(){}y(G,F);G.prototype.peek=function(){return this.h};function H(a){this.g=0;this.h=[];this.o=null;var b=x.j,c=x.m;x.j=this;x.m=null;try{a()}finally{x.j=b,x.m=c}}y(H,F);H.prototype.J=function(){1!==this.g&&(E(this,!0),this.g=1)};function I(a,b){a.g|=16384;null===a.h?a.h=[b]:a.h.push(b)}function J(a){var b=a.g;b&64&&(da(a.A,a.K),a.A=null);if(b&128)for(b=a.s.length;b--;)da(a.s[b], a.G[b]);a.O=a.s=a.G=null}function ea(a,b){if(1!==a.g)if(-1===b)a.A=null,a.g&=-65;else{var c=a.s,d=a.G,e=c.pop(),g=d.pop(),l=c.length;b!==l&&(c[b]=e,d[b]=g,-1===g?e.S=b:e.I[g]=b);0===l&&(a.g&=-129)}}function da(a,b){if(1!==a.g){if(-1===b)a.D=null,a.g&=-257;else{var c=a.B,d=a.I,e=c.pop(),g=d.pop(),l=c.length;b!==l&&(c[b]=e,d[b]=g,-1===g?e.K=b:e.G[g]=b);0===l&&(a.g&=-513)}a.g&768||a.P()}}function fa(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d];e.u<b&&e.H<b&&e.V(b)}}function ha(a,b){for(var c=a.length, d=0;d<c;d++){var e=a[d];e.g&5||e.W(b)}}function K(a,b){var c=a.g;c&64&&a.A.u<b&&a.A.U(b);if(c&128){c=a.s;for(var d=c.length,e=0;e<d;e++)a=c[e],a.u<b&&a.U(b)}}function L(a,b){var c=a.g;c&256&&(ea(a.D,a.S),a.D=null);if(c&512){c=a.B.length;for(var d=0;d<c;d++)ea(a.B[d],a.I[d]);b?(a.B=null,a.I=null):(a.B.length=0,a.I.length=0)}a.g&=-769}function M(a,b){var c=a.g;if(c&1024)throw Error("Circular dependency");if(c&32&&a.H<b)a.L(b);else if(c&50&&(a.C===b||a.H===b)){if(c&2048)throw Error("Circular clearing dependency"); a.g|=2048;a.g&2&&a.H===b&&(a.g&=-3,c=a.j,c.g&50&&M(c,b));a:if(16===(a.g&53)&&a.C===b){if(a.g&256){var d=a.D;c=d.g;if(c&32||c&16&&d.C===b)if(M(d,b),a.g&36)break a}if(a.g&512)for(var e=a.B,g=e.length,l=0;l<g;l++)if(d=e[l],c=d.g,c&32||c&16&&d.C===b)if(M(d,b),a.g&36)break a}a.g&=-2067;a.g&32&&a.L(b)}}function N(a,b,c){c=32|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.j=this.o=this.h=null;this.l=a;this.D=null;this.S=0;this.I=this.B=null;this.H=this.C=this.u=0;a=x.v;b=x.j;c=x.m;null!==b&&I(b,this); x.j=x.m=this;a&&(z(),x.v=!1);try{this.F(),!a||0===t.i&&0===r.i||C()}finally{x.v=a,x.j=b,x.m=c,this.g&768||this.P()}}y(N,H);f=N.prototype;f.J=function(){var a=this.g;1!==a&&(a&49152&&E(this,!0),a&768&&L(this,!0),this.l=null,this.g=1)};f.P=function(){this.l=this.j=this.B=this.I=null};f.V=function(a){this.H=a;this.g=(this.g|2)&-2049;this.C<a&&this.g&16384&&fa(this.h,a)};f.W=function(a){var b=this.u;this.u=a;this.g=(this.g|4)&-51;b<a&&this.g&16384&&ha(this.h,a)};f.T=function(a){this.C=a;this.g=(this.g| 16)&-2049;this.H<a&&this.g&16384&&fa(this.h,a)};f.U=function(a){this.u=a;this.g=(this.g|32)&-17;k(w,this);this.g&16384&&ha(this.h,a)};f.F=function(){this.l()};f.L=function(){var a=this.g,b=x.j,c=x.m;x.j=x.m=null;a&49152&&E(this,!1);a&131072&&(L(this,!1),x.m=this);this.g=(a|1024)&-2099;x.j=this;try{this.F()}finally{this.g&=-1025,x.j=b,x.m=c,this.g&768||this.P()}};function O(a,b,c){c=65568|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.h=void 0;this.A=null;this.K=-1;this.D=this.j=this.G=this.s=null; this.S=0;this.I=this.B=null;this.H=this.C=this.u=0;this.O=void 0;this.l=a;null!==x.j&&I(x.j,this)}y(O,G);f=O.prototype;f.peek=function(){var a=this.g;!(a&5)&&a&1074&&M(this,q);return this.h};f.val=function(){var a=this.g;if(!(a&5)){a&1074&&M(this,q);var b;this.g&13||null===(b=x.m)||A(this,b)}return this.h};f.J=function(){var a=this.g;1!==a&&(this.h=this.l=this.O=null,a&192&&J(this),a&768&&L(this,!0),this.g=1)};f.P=function(){this.g&192&&J(this);this.l=this.O=null};f.F=function(){this.h=this.l()}; f.L=function(a){this.u=a;var b=this.g,c=x.v,d=x.j,e=x.m;x.j=x.m=null;this.g=(this.g|1024)&-2099;b&196608&&(b&65536?this.g&=-65537:L(this,!1),b&262144||(x.m=this));var g=this.h;c&&(z(),x.v=!1);try{this.F(),b&192&&g!==this.h&&(K(this,a),0!==m.i&&ba(a)),!c||0===t.i&&0===r.i||C()}finally{this.g&=-1025,x.v=c,x.j=d,x.m=e,this.g&768||this.P()}};f.W=function(a){this.u=a;this.g=(this.g|4)&-51};f.V=function(a){this.H=a;this.g=(this.g|2)&-2049};f.T=function(a){this.C=a;this.g=(this.g|16)&-2049;this.g&192&&k(m, this)};f.U=function(a){this.u=a;this.g=(this.g|32)&-2065;this.g&192&&(k(u,this),this.C<a&&k(m,this))};function P(a,b){var c=0;void 0!==b&&(c=null===b?c|4096:c|8192);this.g=c;this.h=a;this.l=p;this.O=b;this.A=null;this.K=-1;this.G=this.s=null}y(P,G);f=P.prototype;f.val=function(){var a;this.g&13||null===(a=x.m)||A(this,a);return this.h};f.set=function(a){var b=this.g;if(!(b&9)&&(b&4096||(b&8192?!this.O(a,this.h):a!==this.h)))if(x.v)this.h=a,b&192&&(z(),K(this,q+1),B());else if(this.l===p)this.l=a, this.g|=32,k(t,this);else if(a!==this.l)throw Error("Conflicting values");};f.J=function(){1!==this.g&&(J(this),this.h=this.l=null,this.g=1)};f.F=function(){this.h=this.l;this.l=p;this.g&=-33};f.L=function(a){this.F();K(this,a)};return{root:function(a){return new H(a)},data:function(a){return new P(a,null)},value:function(a,b){return new P(a,b)},compute:function(a,b){return new O(a,b)},$compute:function(a,b){return new O(a,b,131072)},effect: function(a,b){return new N(a,b)},$effect:function(a,b){return new N(a,b,131072)},batch:function(a){x.v?(x.v=!1,z(),a(),B()):a()},sample:function(a){var b=x.m;x.m=null;a=a();x.m=b;return a},cleanup:function(a){if(null!==x.j){var b=x.j;b.g|=32768;null===b.o?b.o=[a]:b.o.push(a)}},stable:function(){null!==x.j&&(x.j.g&=-131073)},Root:H,Data:P,Effect:N,Compute:O,G:G,y:y,O:O,A:A,x:x,I:I,J:J,P:P,z:z,K:K,q:q,B:B,k:k,t:t}})();