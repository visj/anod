var anod=(function(){var g;function h(){this.M=[];this.i=0}function l(a,b){a.M[a.i++]=b}function aa(a,b){for(var c=a.M,d=0;d<a.i;d++)c[d].J(b),c[d]=null;a.i=0}function ba(a){for(var b=m,c=b.M,d=0;d<b.i;d++){var e=c[d],f=a,k=e.g;if(k&64){var n=e.F;n.u<f&&n.C<f&&n.R(f)}if(k&128){e=e.v;k=e.length;for(var G=0;G<k;G++)n=e[G],n.u<f&&n.C<f&&n.R(f)}c[d]=null}b.i=0}function ca(a,b){for(var c=a.M,d=0;d<a.i;d++){var e=c[d];e.g&32&&e.J(b);c[d]=null}a.i=0}var p={},q=1,r=new h,t=new h,m=new h,u=new h,v=new h,w=new h,x={s:!0,j:null, m:null};function y(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a}function z(){r.i=t.i=u.i=v.i=w.i=0}function A(a,b){var c=b.B,d=b.A,e=-1,f=null===c?-1:null===d?0:d.length;!(b.g&65536)&&0<=f&&(c===a||0<f&&(1===f?d[0]===a:d[f-1]===a||d[f-2]===a))||(null===a.F?(a.F=b,a.N=f,a.g|=64):(null===a.v?(e=0,a.v=[b],a.I=[f]):(e=a.v.length,a.v[e]=b,a.I[e]=f),a.g|=128),null===b.B?(b.B=a,b.P=e,b.g|=256):(null===b.A?(b.A=[a],b.G=[e]):(b.A[f]=a,b.G[f]=e),b.g|=512))}function B(){var a=x.j,b= x.m;x.s=!1;try{C()}finally{x.s=!0,x.j=a,x.m=b}}function C(){for(var a,b=0;0!==t.i||0!==m.i||0!==u.i||0!==w.i||0!==v.i||0!==r.i;){a=++q;if(0!==r.i){for(var c=r,d=c.M,e=0;e<c.i;e++)d[e].K(),d[e]=null;c.i=0}0!==t.i&&aa(t,a);0!==m.i&&ba(a);0!==u.i&&ca(u,a);0!==v.i&&ca(v,a);0!==w.i&&aa(w,a);if(1E5<b++)throw Error("Runaway clock detected");}}function D(a,b){var c,d=a.g;if(d&16384){var e=a.h;for(c=e.length-1;0<=c;c--)e[c].K();a.g&=-16385;b?a.h=null:e.length=0}if(d&32768){d=a.o;for(c=d.length-1;0<=c;c--)d[c](!0); a.g&=-32769;b?a.o=null:d.length=0}}function E(){}E.prototype.dispose=function(){this.g&13||(x.s?this.K():(this.g|=8,l(r,this)))};function F(){}y(F,E);F.prototype.peek=function(){return this.h};function H(a){this.g=0;this.h=[];this.o=null;var b=x.j,c=x.m;x.j=this;x.m=null;try{a()}finally{x.j=b,x.m=c}}y(H,E);H.prototype.K=function(){1!==this.g&&(D(this,!0),this.g=1)};function da(a){var b=x.j;b.g|=16384;null===b.h?b.h=[a]:b.h.push(a)}function I(a){var b=a.g;b&64&&(ea(a.F,a.N),a.F=null);if(b&128)for(b= a.v.length;b--;)ea(a.v[b],a.I[b]);a.L=a.v=a.I=null}function fa(a,b){if(1!==a.g)if(-1===b)a.F=null,a.g&=-65;else{var c=a.v,d=a.I,e=c.pop(),f=d.pop(),k=c.length;b!==k&&(c[b]=e,d[b]=f,-1===f?e.P=b:e.G[f]=b);0===k&&(a.g&=-129)}}function ea(a,b){if(1!==a.g){if(-1===b)a.B=null,a.g&=-257;else{var c=a.A,d=a.G,e=c.pop(),f=d.pop(),k=c.length;b!==k&&(c[b]=e,d[b]=f,-1===f?e.N=b:e.I[f]=b);0===k&&(a.g&=-513)}a.g&768||a.O()}}function ha(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d];e.u<b&&e.H<b&&e.U(b)}}function ia(a, b){for(var c=a.length,d=0;d<c;d++){var e=a[d];e.g&5||e.V(b)}}function J(a,b){var c=a.g;c&64&&a.F.u<b&&a.F.S(b);if(c&128){c=a.v;for(var d=c.length,e=0;e<d;e++)a=c[e],a.u<b&&a.S(b)}}function K(a,b){var c=a.g;c&256&&(fa(a.B,a.P),a.B=null);if(c&512){c=a.A.length;for(var d=0;d<c;d++)fa(a.A[d],a.G[d]);b?(a.A=null,a.G=null):(a.A.length=0,a.G.length=0)}a.g&=-769}function L(a,b){var c=a.g;if(c&1024)throw Error("Circular dependency");if(c&32&&a.H<b)a.J(b);else if(c&50&&(a.C===b||a.H===b)){if(c&2048)throw Error("Circular clearing dependency"); a.g|=2048;a.g&2&&a.H===b&&(a.g&=-3,c=a.j,c.g&50&&L(c,b));a:if(16===(a.g&53)&&a.C===b){if(a.g&256){var d=a.B;c=d.g;if(c&32||c&16&&d.C===b)if(L(d,b),a.g&36)break a}if(a.g&512)for(var e=a.A,f=e.length,k=0;k<f;k++)if(d=e[k],c=d.g,c&32||c&16&&d.C===b)if(L(d,b),a.g&36)break a}a.g&=-2067;a.g&32&&a.J(b)}}function M(a,b,c){c=65568|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.j=this.o=this.h=null;this.l=a;this.B=null;this.P=0;this.G=this.A=null;this.H=this.C=this.u=0;null!==x.j&&da(this)}y(M,H);g=M.prototype; g.K=function(){var a=this.g;1!==a&&(a&49152&&D(this,!0),a&768&&K(this,!0),this.l=null,this.g=1)};g.O=function(){this.l=this.j=this.A=this.G=null};g.U=function(a){this.H=a;this.g=(this.g|2)&-2049;this.C<a&&this.g&16384&&ha(this.h,a)};g.V=function(a){var b=this.u;this.u=a;this.g=(this.g|4)&-51;b<a&&this.g&16384&&ia(this.h,a)};g.R=function(a){this.C=a;this.g=(this.g|16)&-2049;this.H<a&&this.g&16384&&ha(this.h,a)};g.S=function(a){this.u=a;this.g=(this.g|32)&-17;l(w,this);this.g&16384&&ia(this.h,a)};g.D= function(){this.l()};g.J=function(a){this.u=a;a=this.g;var b=x.s,c=x.j,d=x.m;this.g=(a|1024)&-2099;x.j=x.m=null;!(a&65536)&&a&49152&&D(this,!1);a&196608&&(a&65536?this.g&=-65537:K(this,!1),x.m=this);b&&(z(),x.s=!1);x.j=this;try{this.D(),!b||0===t.i&&0===r.i||C()}finally{this.g&=-1025,x.s=b,x.j=c,x.m=d,this.g&768||this.O()}};function N(a,b,c){c=65568|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.h=void 0;this.F=null;this.N=-1;this.B=this.j=this.I=this.v=null;this.P=0;this.G=this.A=null;this.H=this.C= this.u=0;this.L=void 0;this.l=a;null!==x.j&&da(this)}y(N,F);g=N.prototype;g.peek=function(){var a=this.g;!(a&5)&&a&1074&&L(this,q);return this.h};g.val=function(){var a=this.g;if(!(a&5)){a&1074&&L(this,q);var b;this.g&13||null===(b=x.m)||A(this,b)}return this.h};g.K=function(){var a=this.g;1!==a&&(this.h=this.l=this.L=null,a&192&&I(this),a&768&&K(this,!0),this.g=1)};g.O=function(){this.g&192&&I(this);this.l=this.L=null};g.D=function(){this.h=this.l()};g.J=function(a){this.u=a;var b=this.g,c=x.s,d= x.j,e=x.m;x.j=x.m=null;this.g=(this.g|1024)&-2099;b&196608&&(b&65536?this.g&=-65537:K(this,!1),x.m=this);var f=this.h;c&&(z(),x.s=!1);try{this.D(),b&192&&f!==this.h&&(J(this,a),0!==m.i&&ba(a)),!c||0===t.i&&0===r.i||C()}finally{this.g&=-1025,x.s=c,x.j=d,x.m=e,this.g&768||this.O()}};g.V=function(a){this.u=a;this.g=(this.g|4)&-51};g.U=function(a){this.H=a;this.g=(this.g|2)&-2049};g.R=function(a){this.C=a;this.g=(this.g|16)&-2049;this.g&192&&l(m,this)};g.S=function(a){this.u=a;this.g=(this.g|32)&-2065; this.g&192&&(l(u,this),this.C<a&&l(m,this))};function O(a,b){var c=0;void 0!==b&&(c=null===b?c|4096:c|8192);this.g=c;this.h=a;this.l=p;this.L=b;this.F=null;this.N=-1;this.I=this.v=null}y(O,F);g=O.prototype;g.val=function(){var a;this.g&13||null===(a=x.m)||A(this,a);return this.h};g.set=function(a){var b=this.g;if(!(b&9)&&(b&4096||(b&8192?!this.L(a,this.h):a!==this.h)))if(x.s)this.h=a,b&192&&(z(),J(this,q+1),B());else if(this.l===p)this.l=a,this.g|=32,l(t,this);else if(a!==this.l)throw Error("Conflicting values"); };g.K=function(){1!==this.g&&(I(this),this.h=this.l=null,this.g=1)};g.D=function(){this.h=this.l;this.l=p;this.g&=-33};g.J=function(a){this.D();J(this,a)};return{root:function(a){return new H(a)},data:function(a){return new O(a,null)},value:function(a,b){return new O(a,b)},compute:function(a,b){return new N(a,b)},effect:function(a,b){a=new M(a,b);a.J(q);return a},batch:function(a){x.s?(x.s=!1,z(),a(),B()):a()},sample:function(a){var b= x.m;x.m=null;a=a();x.m=b;return a},cleanup:function(a){if(null!==x.j){var b=x.j;b.g|=32768;null===b.o?b.o=[a]:b.o.push(a)}},stable:function(){null!==x.j&&(x.j.g&=-131073)},Root:H,Data:O,Effect:M,Compute:N,F:F,y:y,q:q,N:N,A:A,M:M,O:O,x:x,z:z,J:J,B:B,l:l,t:t}})();