var anod=(function(){var f;function g(){this.m=[];this.h=0}function h(a,b){a.m[a.h++]=b}function l(a,b){for(var c=a.m,d=0;d<a.h;d++){var e=c[d];e.g&32&&e.M(b);c[d]=null}a.h=0}var m={},p=1,q=new g,r=new g,t=new g,u=new g,v=new g,w={o:!0,j:null,l:null};function x(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.constructor=a}function y(){q.h=r.h=t.h=u.h=v.h=0}function z(a,b){var c=-1,d=null===b.C?-1:null===b.s?0:b.s.length;null===a.H?(a.H=b,a.O=d,a.g|=64):(null===a.v?(c=0,a.v=[b],a.I=[d]):(c=a.v.length,a.v[c]= b,a.I[c]=d),a.g|=128);null===b.C?(b.C=a,b.P=c,b.g|=256):(null===b.s?(b.s=[a],b.D=[c]):(b.s[d]=a,b.D[d]=c),b.g|=512)}function A(){var a=w.j,b=w.l;w.o=!1;try{B()}finally{w.o=!0,w.j=a,w.l=b}}function B(){for(var a,b=0;0!==r.h||0!==t.h||0!==v.h||0!==u.h||0!==q.h;){a=++p;if(0!==q.h){for(var c=q,d=c.m,e=0;e<c.h;e++)d[e].J(),d[e]=null;c.h=0}0!==r.h&&l(r,a);0!==t.h&&l(t,a);0!==u.h&&l(u,a);0!==v.h&&l(v,a);if(1E5<b++)throw Error("Runaway clock detected");}}function C(a){var b,c=a.g;if(c&16384){var d=a.h;for(b= d.length;b--;)d.pop().J();a.g&=-16385}if(c&32768){c=a.m;for(b=c.length;b--;)c.pop()(!0);a.g&=-32769}}function D(){}D.prototype.dispose=function(){this.g&13||(w.o?this.J():(this.g|=8,h(q,this)))};function E(){}x(E,D);E.prototype.peek=function(){return this.h};function F(a){this.g=0;this.h=[];this.m=null;var b=w.j,c=w.l;w.j=this;w.l=null;try{a()}finally{w.j=b,w.l=c}}x(F,D);F.prototype.J=function(){1!==this.g&&(C(this),this.h=this.m=null,this.g=1)};function G(a){var b=a.g;b&64&&(H(a.H,a.O),a.H=null); if(b&128)for(b=a.v.length;b--;)H(a.v[b],a.I[b]);a.K=a.v=a.I=null}function I(a,b){if(1!==a.g)if(-1===b)a.H=null,a.g&=-65;else{var c=a.v,d=a.I,e=c.pop(),k=d.pop(),n=c.length;b!==n&&(c[b]=e,d[b]=k,-1===k?e.P=b:e.D[k]=b);0===n&&(a.g&=-129)}}function H(a,b){if(1!==a.g){if(-1===b)a.C=null,a.g&=-257;else{var c=a.s,d=a.D,e=c.pop(),k=d.pop(),n=c.length;b!==n&&(c[b]=e,d[b]=k,-1===k?e.O=b:e.I[k]=b);0===n&&(a.g&=-513)}a.g&768||a.L()}}function aa(a,b){a=a.h;for(var c=a.length,d=0;d<c;d++){var e=a[d];e.u<b&&e.G< b&&e.V(b)}}function ba(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d];e.g&5||e.W(b)}}function ca(a,b){var c=a.g;if(c&64){var d=a.H;d.u<b&&d.A<b&&d.T(b)}if(c&128){a=a.v;c=a.length;for(var e=0;e<c;e++)d=a[e],d.u<b&&d.A<b&&d.T(b)}}function J(a,b){var c=a.g;if(c&64){var d=a.H;d.u<b&&d.U(b)}if(c&128){a=a.v;c=a.length;for(var e=0;e<c;e++)d=a[e],d.u<b&&d.U(b)}}function K(a){var b=a.g;b&256&&(I(a.C,a.P),a.C=null);if(b&512)for(b=a.s.length;b--;)I(a.s.pop(),a.D.pop());a.g&=-769}function L(a,b){var c=a.g;if(c& 1024)throw Error("Circular dependency");if(c&32&&a.G<b)a.M(b);else if(c&50&&(a.A===b||a.G===b)){if(c&2048)throw Error("Circular clearing dependency");a.g|=2048;a.g&2&&a.G===b&&(c=a.j,c.g&50&&L(c,b),a.g&=-3);a:if(16===(a.g&53)&&a.A===b){if(a.g&256){var d=a.C;c=d.g;if(c&768&&(c&32||c&16&&d.A===b)&&(L(d,b),a.g&36))break a}if(a.g&512)for(var e=a.s,k=e.length,n=0;n<k;n++)if(d=e[n],c=d.g,c&768&&(c&32||c&16&&d.A===b)&&(L(d,b),a.g&36))break a}a.g&=-2067;a.g&32&&a.M(b)}}function M(a,b,c){c=32|c;null!=b&&b.unstable&& (c|=131072);this.g=c;this.j=this.m=this.h=null;this.i=a;this.C=null;this.P=0;this.D=this.s=null;this.G=this.A=this.u=0;a=w.o;b=w.j;c=w.l;if(null!==b){b.g|=16384;var d=b.h;null===d?b.h=[this]:d[d.length]=this}w.j=w.l=this;a&&(y(),w.o=!1);try{this.B(),!a||0===r.h&&0===q.h||B()}finally{w.o=a,w.j=b,w.l=c,this.g&768||this.L()}}x(M,D);f=M.prototype;f.J=function(){var a=this.g;1!==a&&(a&49152&&C(this),a&768&&K(this),this.h=this.m=this.i=this.s=this.D=null,this.g=1)};f.L=function(){this.i=this.j=this.s=this.D= null};f.V=function(a){this.G=a;this.g=(this.g|2)&-2049;this.A<a&&this.g&16384&&aa(this,a)};f.W=function(a){var b=this.u;this.u=a;this.g=(this.g|4)&-51;b<a&&this.g&16384&&ba(this.h,a)};f.T=function(a){this.A=a;this.g=(this.g|16)&-2049;this.G<a&&this.g&16384&&aa(this,a)};f.U=function(a){this.u=a;this.g=(this.g|32)&-17;this.g&16384&&ba(this.h,a);h(v,this)};f.B=function(){this.i()};f.M=function(){var a=this.g,b=w.j,c=w.l;w.j=w.l=null;a&49152&&C(this);a&131072&&(K(this),w.l=this);this.g=(a|1024)&-2099; w.j=this;try{this.B()}finally{this.g&=-1025,w.j=b,w.l=c,this.g&768||this.L()}};function N(a,b,c){c=65568|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.h=void 0;this.H=null;this.O=-1;this.C=this.j=this.I=this.v=null;this.P=0;this.D=this.s=null;this.G=this.A=this.u=0;this.K=void 0;this.i=a;a=w.j;null!==a&&(a.g|=16384,b=a.h,null===b?a.h=[this]:b[b.length]=this)}x(N,E);f=N.prototype;f.peek=function(){var a=this.g;!(a&5)&&a&1074&&L(this,p);return this.h};f.val=function(){var a=this.g;if(!(a&5)){a&1074&& L(this,p);var b;this.g&13||null===(b=w.l)||z(this,b)}return this.h};f.J=function(){var a=this.g;1!==a&&(a&192&&G(this),a&768&&K(this),this.h=this.i=this.K=this.s=this.D=null,this.g=1)};f.L=function(){this.g&192&&G(this);this.i=this.K=null};f.B=function(){this.h=this.i()};f.M=function(a){this.u=a;var b=this.g,c=w.o,d=w.j,e=w.l;w.j=w.l=null;this.g=(this.g|1024)&-2099;b&196608&&(b&65536?this.g&=-65537:K(this),w.l=this);var k=this.h;c&&(y(),w.o=!1);try{this.B(),!c||0===r.h&&0===q.h||B()}finally{this.g&= -1025,w.o=c,w.j=d,w.l=e,this.g&768||this.L()}b&192&&k!==this.h&&J(this,a)};f.W=function(a){this.u=a;this.g=(this.g|4)&-51};f.V=function(a){this.G=a;this.g=(this.g|2)&-2049};f.T=function(a){this.A=a;this.g=(this.g|16)&-2049;this.g&192&&ca(this,a)};f.U=function(a){this.u=a;this.g=(this.g|32)&-2065;this.g&192&&(h(t,this),this.A<a&&ca(this,a))};function O(a,b){var c=0;void 0!==b&&(c=null===b?c|4096:c|8192);this.g=c;this.h=a;this.i=m;this.K=b;this.H=null;this.O=-1;this.I=this.v=null}x(O,E);f=O.prototype; f.val=function(){var a;this.g&13||null===(a=w.l)||z(this,a);return this.h};f.set=function(a){var b=this.g;if(!(b&9)&&(b&4096||(b&8192?!this.K(a,this.h):a!==this.h)))if(w.o)this.h=a,b&192&&(y(),J(this,p+1),A());else{if(this.i!==m&&a!==this.i)throw Error("Conflicting values");this.i=a;this.g|=32;h(r,this)}};f.J=function(){1!==this.g&&(G(this),this.h=this.i=null,this.g=1)};f.B=function(){this.h=this.i;this.i=m;this.g&=-33};f.M=function(a){this.B();J(this,a)};return{root:function(a){return new F(a)},data:function(a){return new O(a,null)},value:function(a,b){return new O(a,b)},compute:function(a,b){return new N(a,b)},$compute:function(a,b){return new N(a,b,131072)},effect:function(a,b){return new M(a,b)},$effect:function(a,b){return new M(a,b,131072)},batch:function(a){w.o?(w.o=!1,y(),a(),A()):a()},sample:function(a){var b=w.l;w.l=null;a=a();w.l=b;return a},cleanup:function(a){var b=w.j; if(null!==b){b.g|=32768;var c=b.m;null===c?b.m=[a]:c[c.length]=a}},stable:function(){var a=w.j;null!==a&&(a.g&=-131073)},Root:F,Data:O,Effect:M,Compute:N,E:E,x:x,N:N,z:z,O:O,w:w,y:y,J:J,p:p,A:A,h:h,r:r}})();