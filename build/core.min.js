var anod=(function(){var f;function h(){this.i=[];this.h=0}function k(a,b){a.i[a.h++]=b}function m(a,b){for(var c=a.i,d=0;d<a.h;d++){var e=c[d];e.g&32&&e.R(b);c[d]=null}a.h=0}var aa={},n=1,r=new h,t=new h,v=new h,w=new h,x=new h,y={s:!0,j:null,l:null};function z(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a}function A(){r.h=t.h=v.h=w.h=x.h=0}function B(a,b){var c=-1,d=null===b.A?-1:null===b.v?0:b.v.length;null===a.F?(a.F=b,a.L=d,a.g|=64):(null===a.u?(c=0,a.u=[b],a.I=[d]):(c=a.u.length,a.u[c]=b, a.I[c]=d),a.g|=128);null===b.A?(b.A=a,b.P=c,b.g|=256):(null===b.v?(b.v=[a],b.J=[c]):(b.v[d]=a,b.J[d]=c),b.g|=512)}function ba(){var a=y.j,b=y.l;y.s=!1;try{ca()}finally{y.s=!0,y.j=a,y.l=b}}function ca(){for(var a,b=0;0!==t.h||0!==v.h||0!==x.h||0!==w.h||0!==r.h;){a=++n;if(0!==r.h){for(var c=r,d=c.i,e=0;e<c.h;e++)d[e].D(),d[e]=null;c.h=0}0!==t.h&&m(t,a);0!==v.h&&m(v,a);0!==w.h&&m(w,a);0!==x.h&&m(x,a);if(1E5<b++)throw Error("Runaway clock detected");}}function D(a){var b,c=a.g;if(c&16384){var d=a.h;for(b= d.length-1;0<=b;b--)d[b].D();a.g&=-16385;d.length=0}if(c&32768){c=a.m;for(b=c.length-1;0<=b;b--)c[b](!0);a.g&=-32769;c.length=0}}function E(){}E.prototype.dispose=function(){this.g&13||(y.s?this.D():(this.g|=8,k(r,this)))};function F(){}z(F,E);F.prototype.peek=function(){return this.h};function G(a){this.g=0;this.h=[];this.m=null;var b=y.j,c=y.l;y.j=this;y.l=null;try{a()}finally{y.j=b,y.l=c}}z(G,E);G.prototype.D=function(){1!==this.g&&(D(this),this.h=this.m=null,this.g=1)};function H(a){var b=a.g; b&64&&(da(a.F,a.L),a.F=null);if(b&128)for(b=a.u.length;b--;)da(a.u[b],a.I[b]);a.N=a.u=a.I=null}function ea(a,b){if(1!==a.g)if(-1===b)a.F=null,a.g&=-65;else{var c=a.u,d=a.I,e=c.pop(),g=d.pop(),l=c.length;b!==l&&(c[b]=e,d[b]=g,-1===g?e.P=b:e.J[g]=b);0===l&&(a.g&=-129)}}function da(a,b){if(1!==a.g){if(-1===b)a.A=null,a.g&=-257;else{var c=a.v,d=a.J,e=c.pop(),g=d.pop(),l=c.length;b!==l&&(c[b]=e,d[b]=g,-1===g?e.L=b:e.I[g]=b);0===l&&(a.g&=-513)}a.g&768||a.O()}}function fa(a,b){a=a.h;for(var c=a.length,d= 0;d<c;d++){var e=a[d];e.o<b&&e.H<b&&e.U(b)}}function ha(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d];e.g&5||e.V(b)}}function ia(a,b){var c=a.g;if(c&64){var d=a.F;d.o<b&&d.B<b&&d.S(b)}if(c&128){a=a.u;c=a.length;for(var e=0;e<c;e++)d=a[e],d.o<b&&d.B<b&&d.S(b)}}function I(a,b){var c=a.g;if(c&64){var d=a.F;d.o<b&&d.T(b)}if(c&128){a=a.u;c=a.length;for(var e=0;e<c;e++)d=a[e],d.o<b&&d.T(b)}}function J(a){var b=a.g;b&256&&(ea(a.A,a.P),a.A=null);if(b&512)for(b=a.v.length;b--;)ea(a.v.pop(),a.J.pop());a.g&= -769}function K(a,b){var c=a.g;if(c&1024)throw Error("Circular dependency");if(c&32&&a.H<b)a.R(b);else if(c&50&&(a.B===b||a.H===b)){if(c&2048)throw Error("Circular clearing dependency");a.g|=2048;a.g&2&&a.H===b&&(c=a.j,c.g&50&&K(c,b),a.g&=-3);a:if(16===(a.g&53)&&a.B===b){if(a.g&256){var d=a.A;c=d.g;if(c&768&&(c&32||c&16&&d.B===b)&&(K(d,b),a.g&36))break a}if(a.g&512)for(var e=a.v,g=e.length,l=0;l<g;l++)if(d=e[l],c=d.g,c&768&&(c&32||c&16&&d.B===b)&&(K(d,b),a.g&36))break a}a.g&=-2067;a.g&32&&a.R(b)}} function L(a,b,c){c=32|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.j=this.m=this.h=null;this.i=a;this.A=null;this.P=0;this.J=this.v=null;this.H=this.B=this.o=0;a=y.s;b=y.j;c=y.l;if(null!==b){b.g|=16384;var d=b.h;null===d?b.h=[this]:d[d.length]=this}y.j=y.l=this;a&&(A(),y.s=!1);try{this.C(),!a||0===t.h&&0===r.h||ca()}finally{y.s=a,y.j=b,y.l=c,this.g&768||this.O()}}z(L,E);f=L.prototype;f.D=function(){var a=this.g;1!==a&&(a&49152&&D(this),a&768&&J(this),this.h=this.m=this.i=this.v=this.J=null,this.g= 1)};f.O=function(){this.i=this.j=this.v=this.J=null};f.U=function(a){this.H=a;this.g=(this.g|2)&-2049;this.B<a&&this.g&16384&&fa(this,a)};f.V=function(a){var b=this.o;this.o=a;this.g=(this.g|4)&-51;b<a&&this.g&16384&&ha(this.h,a)};f.S=function(a){this.B=a;this.g=(this.g|16)&-2049;this.H<a&&this.g&16384&&fa(this,a)};f.T=function(a){this.o=a;this.g=(this.g|32)&-17;this.g&16384&&ha(this.h,a);k(x,this)};f.C=function(){this.i()};f.R=function(){var a=this.g,b=y.j,c=y.l;y.j=y.l=null;a&49152&&D(this);a&131072&& (J(this),y.l=this);this.g=(a|1024)&-2099;y.j=this;try{this.C()}finally{this.g&=-1025,y.j=b,y.l=c,this.g&768||this.O()}};function M(a,b,c){c=65568|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.h=void 0;this.F=null;this.L=-1;this.A=this.j=this.I=this.u=null;this.P=0;this.J=this.v=null;this.H=this.B=this.o=0;this.N=void 0;this.i=a;a=y.j;null!==a&&(a.g|=16384,b=a.h,null===b?a.h=[this]:b[b.length]=this)}z(M,F);f=M.prototype;f.peek=function(){var a=this.g;!(a&5)&&a&1074&&K(this,n);return this.h};f.val= function(){var a=this.g;if(!(a&5)){a&1074&&K(this,n);var b;this.g&13||null===(b=y.l)||B(this,b)}return this.h};f.D=function(){var a=this.g;1!==a&&(a&192&&H(this),a&768&&J(this),this.h=this.i=this.N=this.v=this.J=null,this.g=1)};f.O=function(){this.g&192&&H(this);this.i=this.N=null};f.C=function(){this.h=this.i()};f.R=function(a){this.o=a;var b=this.g,c=y.s,d=y.j,e=y.l;y.j=y.l=null;this.g=(this.g|1024)&-2099;b&196608&&(b&65536?this.g&=-65537:J(this),b&262144||(y.l=this));var g=this.h;c&&(A(),y.s=!1); try{this.C(),!c||0===t.h&&0===r.h||ca()}finally{this.g&=-1025,y.s=c,y.j=d,y.l=e,this.g&768||this.O()}b&192&&g!==this.h&&I(this,a)};f.V=function(a){this.o=a;this.g=(this.g|4)&-51};f.U=function(a){this.H=a;this.g=(this.g|2)&-2049};f.S=function(a){this.B=a;this.g=(this.g|16)&-2049;this.g&192&&ia(this,a)};f.T=function(a){this.o=a;this.g=(this.g|32)&-2065;this.g&192&&(k(v,this),this.B<a&&ia(this,a))};function N(a,b){var c=0;void 0!==b&&(c=null===b?c|4096:c|8192);this.g=c;this.h=a;this.i=aa;this.N=b;this.F= null;this.L=-1;this.I=this.u=null}z(N,F);f=N.prototype;f.val=function(){var a;this.g&13||null===(a=y.l)||B(this,a);return this.h};f.set=function(a){var b=this.g;if(!(b&9)&&(b&4096||(b&8192?!this.N(a,this.h):a!==this.h)))if(y.s)this.h=a,b&192&&(A(),I(this,n+1),ba());else{if(this.i!==aa&&a!==this.i)throw Error("Conflicting values");this.i=a;this.g|=32;k(t,this)}};f.D=function(){1!==this.g&&(H(this),this.h=this.i=null,this.g=1)};f.C=function(){this.h=this.i;this.i=aa;this.g&=-33};f.R=function(a){this.C(); I(this,a)};return{root:function(a){return new G(a)},data:function(a){return new N(a,null)},value:function(a,b){return new N(a,b)},compute:function(a,b){return new M(a,b)},$compute:function(a,b){return new M(a,b,131072)},effect:function(a,b){return new L(a,b)},$effect:function(a,b){return new L(a,b,131072)},batch:function(a){y.s?(y.s=!1,A(),a(),ba()):a()},sample:function(a){var b=y.l;y.l=null;a=a(); y.l=b;return a},cleanup:function(a){var b=y.j;if(null!==b){b.g|=32768;var c=b.m;null===c?b.m=[a]:c[c.length]=a}},stable:function(){var a=y.j;null!==a&&(a.g&=-131073)},Root:G,Data:N,Effect:L,Compute:M,F:F,z:z,M:M,B:B,y:y,H:H,G:G,D:D,N:N,A:A,I:I,n:n,ba:ba,k:k,t:t}})();