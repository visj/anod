var anod=(function(){var f;function g(){this.i=[];this.h=0}function h(a,b){a.i[a.h++]=b}function l(a,b){for(var c=a.i,d=0;d<a.h;d++){var e=c[d];e.g&32&&e.P(b);c[d]=null}a.h=0}var m={},n=1,q=new g,r=new g,t=new g,u=new g,v=new g,w={s:!0,j:null,l:null};function x(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.constructor=a}function y(){q.h=r.h=t.h=u.h=v.h=0}function z(a,b){var c=-1,d=null===b.D?-1:null===b.u?0:b.u.length;null===a.I?(a.I=b,a.S=d,a.g|=64):(null===a.A?(c=0,a.A=[b],a.K=[d]):(c=a.A.length,a.A[c]= b,a.K[c]=d),a.g|=128);null===b.D?(b.D=a,b.T=c,b.g|=256):(null===b.u?(b.u=[a],b.G=[c]):(b.u[d]=a,b.G[d]=c),b.g|=512)}function A(){var a=w.j,b=w.l;w.s=!1;try{B()}finally{w.s=!0,w.j=a,w.l=b}}function B(){for(var a,b=0;0!==r.h||0!==t.h||0!==v.h||0!==u.h||0!==q.h;){a=++n;if(0!==q.h){for(var c=q,d=c.i,e=0;e<c.h;e++)d[e].M(),d[e]=null;c.h=0}0!==r.h&&l(r,a);0!==t.h&&l(t,a);0!==u.h&&l(u,a);0!==v.h&&l(v,a);if(1E5<b++)throw Error("Runaway clock detected");}}function C(a){var b,c=a.g;if(c&16384){var d=a.h;for(b= d.length;b--;)d.pop().M();a.g&=-16385}if(c&32768){c=a.m;for(b=c.length;b--;)c.pop()(!0);a.g&=-32769}}function D(){}D.prototype.dispose=function(){this.g&13||(w.s?this.M():(this.g|=8,h(q,this)))};function E(){}x(E,D);E.prototype.peek=function(){return this.h};function F(a){this.g=0;this.h=[];this.m=null;var b=w.j,c=w.l;w.j=this;w.l=null;try{a()}finally{w.j=b,w.l=c}}x(F,D);F.prototype.M=function(){1!==this.g&&(C(this),this.h=this.m=null,this.g=1)};function G(a){var b=a.g;b&64&&(aa(a.I,a.S),a.I=null); if(b&128)for(b=a.A.length;b--;)aa(a.A[b],a.K[b]);a.N=a.A=a.K=null}function ba(a,b){if(1!==a.g)if(-1===b)a.I=null,a.g&=-65;else{var c=a.A,d=a.K,e=c.pop(),k=d.pop(),p=c.length;b!==p&&(c[b]=e,d[b]=k,-1===k?e.T=b:e.G[k]=b);0===p&&(a.g&=-129)}}function aa(a,b){if(1!==a.g){if(-1===b)a.D=null,a.g&=-257;else{var c=a.u,d=a.G,e=c.pop(),k=d.pop(),p=c.length;b!==p&&(c[b]=e,d[b]=k,-1===k?e.S=b:e.K[k]=b);0===p&&(a.g&=-513)}a.g&768||a.O()}}function ca(a,b){a=a.h;for(var c=a.length,d=0;d<c;d++){var e=a[d];e.v<b&& e.H<b&&e.W(b)}}function da(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d];e.g&5||e.X(b)}}function ea(a,b){var c=a.g;if(c&64){var d=a.I;d.v<b&&d.B<b&&d.U(b)}if(c&128){a=a.A;c=a.length;for(var e=0;e<c;e++)d=a[e],d.v<b&&d.B<b&&d.U(b)}}function H(a,b){var c=a.g;if(c&64){var d=a.I;d.v<b&&d.V(b)}if(c&128){a=a.A;c=a.length;for(var e=0;e<c;e++)d=a[e],d.v<b&&d.V(b)}}function I(a){var b=a.g;b&256&&(ba(a.D,a.T),a.D=null);if(b&512)for(b=a.u.length;b--;)ba(a.u.pop(),a.G.pop());a.g&=-769}function J(a,b){var c= a.g;if(c&1024)throw Error("Circular dependency");if(c&32&&a.H<b)a.P(b);else if(c&50&&(a.B===b||a.H===b)){if(c&2048)throw Error("Circular clearing dependency");a.g|=2048;a.g&2&&a.H===b&&(c=a.j,c.g&50&&J(c,b),a.g&=-3);a:if(16===(a.g&53)&&a.B===b){if(a.g&256){var d=a.D;c=d.g;if(c&768&&(c&32||c&16&&d.B===b)&&(J(d,b),a.g&36))break a}if(a.g&512)for(var e=a.u,k=e.length,p=0;p<k;p++)if(d=e[p],c=d.g,c&768&&(c&32||c&16&&d.B===b)&&(J(d,b),a.g&36))break a}a.g&=-2067;a.g&32&&a.P(b)}}function K(a,b,c){c=32|c;null!= b&&b.unstable&&(c|=131072);this.g=c;this.j=this.m=this.h=null;this.i=a;this.D=null;this.T=0;this.G=this.u=null;this.H=this.B=this.v=0;a=w.s;b=w.j;c=w.l;if(null!==b){b.g|=16384;var d=b.h;null===d?b.h=[this]:d[d.length]=this}w.j=w.l=this;a&&(y(),w.s=!1);try{this.C(),!a||0===r.h&&0===q.h||B()}finally{w.s=a,w.j=b,w.l=c,this.g&768||this.O()}}x(K,D);f=K.prototype;f.M=function(){var a=this.g;1!==a&&(a&49152&&C(this),a&768&&I(this),this.h=this.m=this.i=this.u=this.G=null,this.g=1)};f.O=function(){this.i= this.j=this.u=this.G=null};f.W=function(a){this.H=a;this.g=(this.g|2)&-2049;this.B<a&&this.g&16384&&ca(this,a)};f.X=function(a){var b=this.v;this.v=a;this.g=(this.g|4)&-51;b<a&&this.g&16384&&da(this.h,a)};f.U=function(a){this.B=a;this.g=(this.g|16)&-2049;this.H<a&&this.g&16384&&ca(this,a)};f.V=function(a){this.v=a;this.g=(this.g|32)&-17;this.g&16384&&da(this.h,a);h(v,this)};f.C=function(){this.i()};f.P=function(){var a=this.g,b=w.j,c=w.l;w.j=w.l=null;a&49152&&C(this);a&131072&&(I(this),w.l=this); this.g=(a|1024)&-2099;w.j=this;try{this.C()}finally{this.g&=-1025,w.j=b,w.l=c,this.g&768||this.O()}};function L(a,b,c){c=65568|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.h=void 0;this.I=null;this.S=-1;this.D=this.j=this.K=this.A=null;this.T=0;this.G=this.u=null;this.H=this.B=this.v=0;this.N=void 0;this.i=a;a=w.j;null!==a&&(a.g|=16384,b=a.h,null===b?a.h=[this]:b[b.length]=this)}x(L,E);f=L.prototype;f.peek=function(){var a=this.g;!(a&5)&&a&1074&&J(this,n);return this.h};f.val=function(){var a= this.g;if(!(a&5)){a&1074&&J(this,n);var b;this.g&13||null===(b=w.l)||z(this,b)}return this.h};f.M=function(){var a=this.g;1!==a&&(a&192&&G(this),a&768&&I(this),this.h=this.i=this.N=this.u=this.G=null,this.g=1)};f.O=function(){this.g&192&&G(this);this.i=this.N=null};f.C=function(){this.h=this.i()};f.P=function(a){this.v=a;var b=this.g,c=w.s,d=w.j,e=w.l;w.j=w.l=null;this.g=(this.g|1024)&-2099;b&196608&&(b&65536?this.g&=-65537:I(this),w.l=this);var k=this.h;c&&(y(),w.s=!1);try{this.C(),!c||0===r.h&& 0===q.h||B()}finally{this.g&=-1025,w.s=c,w.j=d,w.l=e,this.g&768||this.O()}b&192&&k!==this.h&&H(this,a)};f.X=function(a){this.v=a;this.g=(this.g|4)&-51};f.W=function(a){this.H=a;this.g=(this.g|2)&-2049};f.U=function(a){this.B=a;this.g=(this.g|16)&-2049;this.g&192&&ea(this,a)};f.V=function(a){this.v=a;this.g=(this.g|32)&-2065;this.g&192&&(h(t,this),this.B<a&&ea(this,a))};function M(a,b){var c=0;void 0!==b&&(c=null===b?c|4096:c|8192);this.g=c;this.h=a;this.i=m;this.N=b;this.I=null;this.S=-1;this.K=this.A= null}x(M,E);f=M.prototype;f.val=function(){var a;this.g&13||null===(a=w.l)||z(this,a);return this.h};f.set=function(a){var b=this.g;if(!(b&9)&&(b&4096||(b&8192?!this.N(a,this.h):a!==this.h)))if(w.s)this.h=a,b&192&&(y(),H(this,n+1),A());else{if(this.i!==m&&a!==this.i)throw Error("Conflicting values");this.i=a;this.g|=32;h(r,this)}};f.M=function(){1!==this.g&&(G(this),this.h=this.i=null,this.g=1)};f.C=function(){this.h=this.i;this.i=m;this.g&=-33};f.P=function(a){this.C();H(this,a)};return{root: function(a){return new F(a)},data:function(a){return new M(a,null)},value:function(a,b){return new M(a,b)},compute:function(a,b){return new L(a,b)},$compute:function(a,b){return new L(a,b,131072)},effect:function(a,b){return new K(a,b)},$effect:function(a,b){return new K(a,b,131072)},batch:function(a){w.s?(w.s=!1,y(),a(),A()):a()},sample:function(a){var b=w.l;w.l=null;a=a();w.l=b;return a},cleanup: function(a){var b=w.j;if(null!==b){b.g|=32768;var c=b.m;null===c?b.m=[a]:c[c.length]=a}},stable:function(){var a=w.j;null!==a&&(a.g&=-131073)},Root:F,Data:M,Effect:K,Compute:L,E:E,x:x,F:F,L:L,z:z,M:M,w:w,y:y,H:H,n:n,A:A,h:h,r:r}})();