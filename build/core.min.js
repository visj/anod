var anod=(function(){var f;function h(){this.i=[];this.h=0}function k(a,b){a.i[a.h++]=b}function aa(a,b){for(var c=a.i,d=0;d<a.h;d++){var e=c[d];e.g&32&&e.M(b);c[d]=null}a.h=0}function ba(a,b){for(var c=a.i,d=0;d<a.h;d++)c[d].M(b),c[d]=null;a.h=0}var ca={},m=1,n=new h,r=new h,t=new h,v=new h,w=new h,x={s:!0,j:null,l:null};function y(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a}function z(){n.h=r.h=t.h=v.h=w.h=0}function A(a,b){var c=-1,d=null===b.A?-1:null===b.v?0:b.v.length;null===a.F?(a.F=b, a.L=d,a.g|=64):(null===a.u?(c=0,a.u=[b],a.I=[d]):(c=a.u.length,a.u[c]=b,a.I[c]=d),a.g|=128);null===b.A?(b.A=a,b.R=c,b.g|=256):(null===b.v?(b.v=[a],b.J=[c]):(b.v[d]=a,b.J[d]=c),b.g|=512)}function da(){var a=x.j,b=x.l;x.s=!1;try{ea()}finally{x.s=!0,x.j=a,x.l=b}}function ea(){for(var a,b=0;0!==r.h||0!==t.h||0!==w.h||0!==v.h||0!==n.h;){a=++m;if(0!==n.h){for(var c=n,d=c.i,e=0;e<c.h;e++)d[e].D(),d[e]=null;c.h=0}0!==r.h&&ba(r,a);0!==t.h&&aa(t,a);0!==v.h&&aa(v,a);0!==w.h&&ba(w,a);if(1E5<b++)throw Error("Runaway clock detected"); }}function B(a,b){var c,d=a.g;if(d&16384){var e=a.h;for(c=e.length-1;0<=c;c--)e[c].D();a.g&=-16385;b?a.h=null:e.length=0}if(d&32768){d=a.m;for(c=d.length-1;0<=c;c--)d[c](!0);a.g&=-32769;b?a.m=null:d.length=0}}function D(){}D.prototype.dispose=function(){this.g&13||(x.s?this.D():(this.g|=8,k(n,this)))};function E(){}y(E,D);E.prototype.peek=function(){return this.h};function F(a){this.g=0;this.h=[];this.m=null;var b=x.j,c=x.l;x.j=this;x.l=null;try{a()}finally{x.j=b,x.l=c}}y(F,D);F.prototype.D=function(){1!== this.g&&(B(this,!0),this.g=1)};function G(a){var b=a.g;b&64&&(fa(a.F,a.L),a.F=null);if(b&128)for(b=a.u.length;b--;)fa(a.u[b],a.I[b]);a.O=a.u=a.I=null}function ha(a,b){if(1!==a.g)if(-1===b)a.F=null,a.g&=-65;else{var c=a.u,d=a.I,e=c.pop(),g=d.pop(),l=c.length;b!==l&&(c[b]=e,d[b]=g,-1===g?e.R=b:e.J[g]=b);0===l&&(a.g&=-129)}}function fa(a,b){if(1!==a.g){if(-1===b)a.A=null,a.g&=-257;else{var c=a.v,d=a.J,e=c.pop(),g=d.pop(),l=c.length;b!==l&&(c[b]=e,d[b]=g,-1===g?e.L=b:e.I[g]=b);0===l&&(a.g&=-513)}a.g& 768||a.P()}}function ia(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d];e.o<b&&e.H<b&&e.U(b)}}function ja(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d];e.g&5||e.V(b)}}function ka(a,b){var c=a.g;if(c&64){var d=a.F;d.o<b&&d.B<b&&d.S(b)}if(c&128){a=a.u;c=a.length;for(var e=0;e<c;e++)d=a[e],d.o<b&&d.B<b&&d.S(b)}}function H(a,b){var c=a.g;c&64&&a.F.o<b&&a.F.T(b);if(c&128){c=a.u;for(var d=c.length,e=0;e<d;e++)a=c[e],a.o<b&&a.T(b)}}function I(a,b){var c=a.g;c&256&&(ha(a.A,a.R),a.A=null);if(c&512){c=a.v.length; for(var d=0;d<c;d++)ha(a.v[d],a.J[d]);b?(a.v=null,a.J=null):(a.v.length=0,a.J.length=0)}a.g&=-769}function J(a,b){var c=a.g;if(c&1024)throw Error("Circular dependency");if(c&32&&a.H<b)a.M(b);else if(c&50&&(a.B===b||a.H===b)){if(c&2048)throw Error("Circular clearing dependency");a.g|=2048;a.g&2&&a.H===b&&(c=a.j,c.g&50&&J(c,b),a.g&=-3);a:if(16===(a.g&53)&&a.B===b){if(a.g&256){var d=a.A;c=d.g;if(c&768&&(c&32||c&16&&d.B===b)&&(J(d,b),a.g&36))break a}if(a.g&512)for(var e=a.v,g=e.length,l=0;l<g;l++)if(d= e[l],c=d.g,c&768&&(c&32||c&16&&d.B===b)&&(J(d,b),a.g&36))break a}a.g&=-2067;a.g&32&&a.M(b)}}function K(a,b,c){c=32|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.j=this.m=this.h=null;this.i=a;this.A=null;this.R=0;this.J=this.v=null;this.H=this.B=this.o=0;a=x.s;b=x.j;c=x.l;if(null!==b){b.g|=16384;var d=b.h;null===d?b.h=[this]:d[d.length]=this}x.j=x.l=this;a&&(z(),x.s=!1);try{this.C(),!a||0===r.h&&0===n.h||ea()}finally{x.s=a,x.j=b,x.l=c,this.g&768||this.P()}}y(K,D);f=K.prototype;f.D=function(){var a= this.g;1!==a&&(a&49152&&B(this,!0),a&768&&I(this,!0),this.h=this.m=this.i=null,this.g=1)};f.P=function(){this.i=this.j=this.v=this.J=null};f.U=function(a){this.H=a;this.g=(this.g|2)&-2049;this.B<a&&this.g&16384&&ia(this.h,a)};f.V=function(a){var b=this.o;this.o=a;this.g=(this.g|4)&-51;b<a&&this.g&16384&&ja(this.h,a)};f.S=function(a){this.B=a;this.g=(this.g|16)&-2049;this.H<a&&this.g&16384&&ia(this.h,a)};f.T=function(a){this.o=a;this.g=(this.g|32)&-17;this.g&16384&&ja(this.h,a);k(w,this)};f.C=function(){this.i()}; f.M=function(){var a=this.g,b=x.j,c=x.l;x.j=x.l=null;a&49152&&B(this,!1);a&131072&&(I(this,!1),x.l=this);this.g=(a|1024)&-2099;x.j=this;try{this.C()}finally{this.g&=-1025,x.j=b,x.l=c,this.g&768||this.P()}};function L(a,b,c){c=65568|c;null!=b&&b.unstable&&(c|=131072);this.g=c;this.h=void 0;this.F=null;this.L=-1;this.A=this.j=this.I=this.u=null;this.R=0;this.J=this.v=null;this.H=this.B=this.o=0;this.O=void 0;this.i=a;a=x.j;null!==a&&(a.g|=16384,b=a.h,null===b?a.h=[this]:b[b.length]=this)}y(L,E);f=L.prototype; f.peek=function(){var a=this.g;!(a&5)&&a&1074&&J(this,m);return this.h};f.val=function(){var a=this.g;if(!(a&5)){a&1074&&J(this,m);var b;this.g&13||null===(b=x.l)||A(this,b)}return this.h};f.D=function(){var a=this.g;1!==a&&(a&192&&G(this),a&768&&I(this,!0),this.h=this.i=this.O=null,this.g=1)};f.P=function(){this.g&192&&G(this);this.i=this.O=null};f.C=function(){this.h=this.i()};f.M=function(a){this.o=a;var b=this.g,c=x.s,d=x.j,e=x.l;x.j=x.l=null;this.g=(this.g|1024)&-2099;b&196608&&(b&65536?this.g&= -65537:I(this,!1),b&262144||(x.l=this));var g=this.h;c&&(z(),x.s=!1);try{this.C(),!c||0===r.h&&0===n.h||ea()}finally{this.g&=-1025,x.s=c,x.j=d,x.l=e,this.g&768||this.P()}b&192&&g!==this.h&&H(this,a)};f.V=function(a){this.o=a;this.g=(this.g|4)&-51};f.U=function(a){this.H=a;this.g=(this.g|2)&-2049};f.S=function(a){this.B=a;this.g=(this.g|16)&-2049;this.g&192&&ka(this,a)};f.T=function(a){this.o=a;this.g=(this.g|32)&-2065;this.g&192&&(k(t,this),this.B<a&&ka(this,a))};function M(a,b){var c=0;void 0!== b&&(c=null===b?c|4096:c|8192);this.g=c;this.h=a;this.i=ca;this.O=b;this.F=null;this.L=-1;this.I=this.u=null}y(M,E);f=M.prototype;f.val=function(){var a;this.g&13||null===(a=x.l)||A(this,a);return this.h};f.set=function(a){var b=this.g;if(!(b&9)&&(b&4096||(b&8192?!this.O(a,this.h):a!==this.h)))if(x.s)this.h=a,b&192&&(z(),H(this,m+1),da());else if(this.i===ca)this.i=a,this.g|=32,k(r,this);else if(a!==this.i)throw Error("Conflicting values");};f.D=function(){1!==this.g&&(G(this),this.h=this.i=null,this.g= 1)};f.C=function(){this.h=this.i;this.i=ca;this.g&=-33};f.M=function(a){this.C();H(this,a)};return{root:function(a){return new F(a)},data:function(a){return new M(a,null)},value:function(a,b){return new M(a,b)},compute:function(a,b){return new L(a,b)},$compute:function(a,b){return new L(a,b,131072)},effect:function(a,b){return new K(a,b)},$effect:function(a,b){return new K(a,b,131072)},batch:function(a){x.s?(x.s= !1,z(),a(),da()):a()},sample:function(a){var b=x.l;x.l=null;a=a();x.l=b;return a},cleanup:function(a){var b=x.j;if(null!==b){b.g|=32768;var c=b.m;null===c?b.m=[a]:c[c.length]=a}},stable:function(){var a=x.j;null!==a&&(a.g&=-131073)},Root:F,Data:M,Effect:K,Compute:L,E:E,y:y,L:L,A:A,x:x,G:G,F:F,B:B,M:M,z:z,H:H,m:m,da:da,k:k,r:r}})();